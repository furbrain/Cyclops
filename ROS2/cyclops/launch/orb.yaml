launch:
  - arg:
      name: orb_exec
      default: "rgbd"
  - arg:
      name: ros_home
      default: '$(env ROS_HOME "$(env HOME)/.ros")'
  - arg:
      name: ns
      default: ''

  - node:
      pkg: orb_slam3
      exec: "ros_$(var orb_exec)"
      namespace: orb
      name: ORB
      param:
        - name: settings_file
          value: "$(var ros_home)/orb_slam3.yaml"
        - name: voc_file
          value: "$(find-pkg-share orb_slam3)/vocab/ORBvoc.txt.bin"
        - name: world_frame_id
          value: map
        - name: cam_frame_id
          value: rgb
        - name: imu_frame_id
          value: imu
      remap:
        - from: /camera/rgb/image_raw
          to: /rgb/image_raw
        - from: /camera/depth_registered/image_raw
          to: /rgb/depth_registered
        - from: /imu
          to: /imu/imu_rect

  - node:
      pkg: cyclops_cpp
      exec: register_node
      name: register
      namespace: "$(var ns)/tof"
      param:
        - name: radial_source
          value: True
        - name: rectified_source
          value: False
        - name: rectified_dest
          value: False
        - name: fill_upsampling_holes
          value: True
      remap:
        - from: rgb/camera_info
          to: "$(var ns)/rgb/camera_info"
        - from: depth/image_rect
          to: depth_raw
        - from: depth/camera_info
          to: camera_info
        - from: depth_registered/image_rect
          to: "$(var ns)/rgb/depth_registered"
